WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-editor-plugin:split_core~page-editor-quit-dialog', location = 'core~page-editor-quit-dialog.js' */
(window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff=window.atlassianWebpackJsonp1126d6c3ec4535e33734b1025bd581ff||[]).push([["core~page-editor-quit-dialog"],[,,function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return s}));var o=a(1),n=a.n(o),i=a(0),r=a.n(i);function l(e,t,a){return"function"==typeof a?n()(r.a).bind(e,t,a):n()(r.a).bind(e,t)}function d(e,t){return n()(r.a).unbind(e,t)}function s(e,t){return n()(r.a).trigger(e,t)}},function(e,t,a){"use strict";var o=a(14),n=a.n(o);t.a=n.a},function(e,t,a){"use strict";var o,n="[EDITOR]",i="confluence.editor.log-level";!function(e){e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG"}(o||(o={}));var r,l=o.WARN;function d(e){return e<=function(){try{var e;return Number.isInteger(r)||(r=parseInt(null!==(e=window.localStorage.getItem(i))&&void 0!==e?e:""),Number.isInteger(r)||(r=l)),r}catch(e){console.error(n,"localStorage reading error",e)}return l}()}function s(){if(d(o.INFO)){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.info(n,...t)}}function c(e){return`${n} ${e}`}t.a={debug:function(){if(d(o.DEBUG)){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.debug(n,...t)}},error:function(){if(d(o.ERROR)){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.error(n,...t)}},info:s,warn:function(){if(d(o.WARN)){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.warn(n,...t)}},time:function(e){d(o.DEBUG)&&(s(`${e} started`),console.time(c(e)))},timeEnd:function(e){d(o.DEBUG)&&console.timeEnd(c(e))},setLogLevel:function(e){r=e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var o=a(6),n=a.n(o),i=a(4),r={"editor.autocomplete.macros.header.text":"Suggestions de macros","editor.autocomplete.macros.dialog.browse":"Ouvrir le navigateur de macros","editor.autocomplete.macros.error.load.header":"Impossible d\u0027obtenir les d\u00e9tails de la macro","editor.autocomplete.macros.error.load.retrylink":"R\u00e9essayer","editor.autocomplete.links.header.text":"Suggestions de liens","editor.autocomplete.links.dialog.search":"Rechercher &lsquo;{0}&rsquo;","editor.autocomplete.links.dialog.search.no.text":"Rechercher","editor.autocomplete.links.web.link":"Ins\u00e9rer un lien Web","editor.autocomplete.links.create.link":"Ins\u00e9rer un lien pour cr\u00e9er une page","editor.autocomplete.file.header.text":"Suggestions de fichier","editor.autocomplete.media.header.text":"Suggestions de supports","editor.autocomplete.media.files.dialog.browse":"Ouvrir la librairie de fichiers","editor.autocomplete.media.macros.dialog.browse":"Ins\u00e9rer un autre support","editor.autoformat.sampletext.firstcell":"premi\u00e8re cellule","editor.autoformat.sampletext.heading":"en-t\u00eate","tinymce.advanced.charmap_desc":"Symbole","tinymce.charmap_dlg.success.text":"Symbole ins\u00e9r\u00e9","tinymce.charmap_dlg.title":"Ins\u00e9rer un symbole","tinymce.charmap_dlg.search.label":"Rechercher un symbole","calendar3.helptip.learn.more":"En apprendre plus","tinymce.confluence.placeholder.inline.tasks":"Saisissez votre t\u00e2che ici, en utilisant \u00ab\u00a0@\u00a0\u00bb pour l\u0027attribution \u00e0 un utilisateur et \u00ab\u00a0//\u00a0\u00bb pour s\u00e9lectionner une date d\u0027\u00e9ch\u00e9ance","tinymce.confluence.files":"Fichiers","tinymce.confluence.conf_file_desc":"Ins\u00e9rer des fichiers et des images","tinymce.confluence.conf_file_shortcut":"Ctrl+M","tinymce.charmap_dlg.nothing.text":"Symbole introuvable","tinymce.confluence.conf_wikimarkup_conversion_errors":"Erreurs de conversion du format Wiki","tinymce.confluence.conf_wikimarkup_timeout":"Le serveur a pris trop de temps pour convertir le format Wiki. Ce probl\u00e8me peut \u00eatre temporaire et vous pouvez tenter \u00e0 nouveau.","tinymce.confluence.conf_wikimarkup_info_title":"Saisissez la balise wiki ci-dessous. Confluence va converger votre contenu dans un format \u00e9diteur et l\u0027ins\u00e9rer dans votre page.","tinymce.confluence.conf_wikimarkup.insert.label":"Ins\u00e9rer","tinymce.confluence.conf_wikimarkup_preview_label":"Aper\u00e7u","editor.minor.edit":"Notifier les observateurs","property.panel.textplaceholder.display.default":"Texte","property.panel.textplaceholder.display.default.tooltip":"Le texte d\u0027instructions est remplac\u00e9 par un contenu vide lors de la saisie par un utilisateur.","property.panel.textplaceholder.remove":"Supprimer","editor.shared.draft.done.desc":"Enregistrer le brouillon et fermer l\u2019\u00e9diteur","editor.change.comment":"Qu\u0027avez-vous modifi\u00e9 ?","tinymce.tablepicker.insert_table_title":"Ins\u00e9rer un tableau","com.atlassian.confluence.extra.team-calendars.calendar.helptip.close":"D\u0027accord","comment.notification.enable":"Surveiller cette page","page-layout-2.layout.group":"Appliquez la mise en page","page-layout-2.layout.single":"Section \u00e0 colonne unique","page-layout-2.layout.two-equal":"Section \u00e0 deux colonnes","page-layout-2.layout.two-left-sidebar":"Section \u00e0 deux colonnes avec encadr\u00e9 gauche","page-layout-2.layout.two-right-sidebar":"Section \u00e0 deux colonnes avec encadr\u00e9 droit","page-layout-2.layout.three-equal":"Section \u00e0 trois colonnes","page-layout-2.layout.three-with-sidebars":"Section \u00e0 trois colonnes avec encadr\u00e9s","page-layout-2.add-section":"Ajoutez une section","page-layout-2.add-section.tooltip":"Ajoutez une nouvelle section ci-dessous","page-layout-2.remove-section":"Supprimez la section","page-layout-2.remove-section.tooltip":"Supprimez la section actuelle","page-layout-2.move-section-up":"D\u00e9placer vers le haut","page-layout-2.move-section-up.tooltip":"D\u00e9placez la section vers le haut","page-layout-2.move-section-down":"D\u00e9placer vers le bas","page-layout-2.move-section-down.tooltip":"D\u00e9placez la section vers le bas","page-layout-2.close":"Fermez la barre d\u0027outils","cancel.name":"Annuler","close.name":"Fermer","content.empty":"Le texte du commentaire est vide. La cr\u00e9ation de commentaires vides est impossible.","edit.name":"Modifier","heading.key":"L\u00e9gende","heartbeat.page.edited.info":"Cette page est \u00e9galement en cours de modification par {0}. Vos modifications seront fusionn\u00e9es avec les siennes lorsque vous sauvegardez.","mysql.utf8.content.validation.failed.message":"Enregistrement impossible : le caract\u00e8re {0} n\u0027est pas pris en charge par votre base de donn\u00e9es.\u003cbr\u003e\u003cbr\u003eSupprimez ce caract\u00e8re ou utilisez un symbole ou une \u00e9motic\u00f4ne Confluence \u00e0 la place. \u003ca href = \u0022https://confluence.atlassian.com/x/BYfsNg\u0022 target=\u0022_blank\u0022\u003eEn savoir plus\u003c/a\u003e","mysql.utf8.content.validation.failed.title":"Caract\u00e8re non pris en charge","page.restrictions.apply":"Des restrictions sont en vigueur","page.restrictions.none":"Sans restriction","publish.name":"Publier","show.preview":"Aper\u00e7u","these.lines.were.added":"Ces lignes ont \u00e9t\u00e9 ajout\u00e9es. Ce \u003cspan class=\u0022diffaddedchars\u0022\u003emot\u003c/span\u003e a \u00e9t\u00e9 ajout\u00e9.","these.lines.were.removed":"Ces lignes ont \u00e9t\u00e9 supprim\u00e9es. Ce \u003cspan class=\u0022diffremovedchars\u0022\u003emot\u003c/span\u003e a \u00e9t\u00e9 supprim\u00e9.","this.content.was.modified":"La mise en forme a \u00e9t\u00e9 modifi\u00e9e.","tinymce.confluence.preview":"Pr\u00e9visualiser","unsaved.comment.lost":"Votre commentaire sera perdu.","unsaved.template.lost":"Vos modifications du mod\u00e8les seront perdues.","update.word":"Mettre \u00e0 jour","editor.collaborative.mode.disabled":"Copiez toutes les modifications que vous souhaitez conserver, puis actualisez la page pour continuer \u00e0 \u00e9diter.","editor.collaborative.mode.enabled":"L\u0027\u00e9dition collaborative \u00e9tait d\u00e9sactiv\u00e9e, mais elle fonctionne \u00e0 nouveau. Copiez vos modifications et mettez \u00e0 jour la page pour continuer \u00e0 \u00e9diter.","editor.discard-to-published.error.message":"Nous ne pouvons pas obtenir la derni\u00e8re version publi\u00e9e de la page pour le moment. Patientez quelques instants puis essayez de supprimer \u00e0 nouveau le projet.","editor.discard-to-published.error.title":"Impossible de revenir \u00e0 la derni\u00e8re version publi\u00e9e","editor.discard-to-published.success.message":"Vous avez r\u00e9ussi \u00e0 revenir \u00e0 la derni\u00e8re version publi\u00e9e","editor.generic.refresh":"Il y a eu un probl\u00e8me avec l\u0027\u00e9diteur. Copiez les modifications et rafra\u00eechissez la page pour continuer \u00e0 faire des modifications.","editor.labels.plural":"\u00c9tiquettes {0}","editor.labels.singular":"\u00c9tiquette {0}","editor.labels.zero":"\u00c9tiquettes","editor.offline.before.save.error":"Impossible de communiquer avec le serveur. Impossible d\u0027enregistrer pour le moment.","editor.offline.preview.error":"Impossible d\u0027atteindre le serveur. V\u00e9rifiez que vous \u00eates connect\u00e9 \u00e0 Internet et que Confluence fonctionne.","editor.page.legacy.draft.deprecated":"La modification collaborative est arriv\u00e9e ! Cela signifie que nous allons sollicit\u00e9 votre aide pour reprendre la session de modifications. Vous devez copier le contenu, modifier cette page \u00e0 nouveau puis la coller et l\u0027enregistrer.","editor.publish.blog.desc":"Publier le billet de blog","editor.publish.blog":"Publier","editor.restrictions.icon.editor-restricted":"Modifier les restrictions de page. \u00c9tat actuel\u00a0: des restrictions sont en vigueur","editor.restrictions.icon.editor-unrestricted":"Modifier les restrictions de page. \u00c9tat actuel\u00a0: sans restriction","editor.save.page.desc":"Sauvegarder la page","editor.save.page":"Enregistrer","editor.shared.draft.publish.desc":"Publier les modifications","editor.shared.draft.update.desc":"Mettre \u00e0 jour la page publi\u00e9e","discard.draft.page-published.error.title":"Cette page a d\u00e9j\u00e0 \u00e9t\u00e9 publi\u00e9e","discard.draft.page-published.error":"Vous ne pouvez plus supprimer ce brouillon, car ce n\u0027est plus un brouillon !","discard.draft.unknown.error":"Une erreur inconnue s\u0027est produite. Veuillez v\u00e9rifier vos journaux.","draft.autosaved.at.new":"Brouillon enregistr\u00e9 automatiquement \u00e0 {0}","draft.saved.at.new":"Brouillon sauvegard\u00e9 \u00e0 {0}","draft.saving.error.could.not.delete":"Des erreurs sont survenues lors de la suppression de votre brouillon.","draft.saving.error.previous.draft":"Erreur de la sauvegarde du brouillon. Dernier brouillon sauvegard\u00e9 \u00e0 {0}","draft.saving.error":"Erreur de la sauvegarde du brouillon. Aucun brouillon n\u0027a \u00e9t\u00e9 sauvegard\u00e9.","saved.draft":"Un brouillon sera enregistr\u00e9. Vous pouvez reprendre la modification de ce brouillon la prochaine fois que vous ouvrez l\u0027\u00e9diteur ou que vous affichez tous vos brouillons dans votre profil.","saved.shared.draft.leave.page":"Nous n\u0027avons pas termin\u00e9 d\u0027enregistrer vos modifications. Si vous partez avant de voir le message \u0027 Projet enregistr\u00e9 \u0027, vous risquez de perdre vos modifications.","editor.quit-dialog.delete.blogpost.changes.by.many":"Ceci supprimera de mani\u00e8re permanente cet article de blog sur lequel vous et ces autres personnes ont travaill\u00e9.","editor.quit-dialog.delete.blogpost.changes.by.one":"Une fois que vous aurez supprim\u00e9e un article de blog non publi\u00e9, il ne pourra plus \u00eatre r\u00e9cup\u00e9r\u00e9.","editor.quit-dialog.delete.page.changes.by.many":"Ceci supprimera de mani\u00e8re permanente cette page sur laquelle vous et ces autres personnes ont travaill\u00e9.","editor.quit-dialog.delete.page.changes.by.one":"Si vous supprimez une page non publi\u00e9e, elle ne pourra plus \u00eatre r\u00e9cup\u00e9r\u00e9e.","editor.quit-dialog.link.hide.diff":"Afficher les contributeurs","editor.quit-dialog.link.show.diff":"Afficher les modifications","editor.quit-dialog.publish.changes":"\u003cp\u003e Certaines modifications que vous avez apport\u00e9es ou qui l\u0027ont \u00e9t\u00e9 par d\u0027autres personnes n\u0027ont pas encore \u00e9t\u00e9 publi\u00e9es. \u003c/p\u003e\u003cp\u003e Les personnes suivantes ont apport\u00e9 des modifications : \u003c/p\u003e","editor.quit-dialog.revert.blogpost.changes.by.one":"Cela supprimera de mani\u00e8re permanente toutes les modifications que vous avez effectu\u00e9e depuis que cet article de blog a \u00e9t\u00e9 publi\u00e9 pour la derni\u00e8re fois","editor.quit-dialog.revert.changes.by.many":"Cela supprimera de mani\u00e8re permanente toutes les modifications que les personnes suivantes ont effectu\u00e9es depuis que cette page a \u00e9t\u00e9 publi\u00e9e pour la derni\u00e8re fois","editor.quit-dialog.revert.page.changes.by.one":"Cela supprimera de mani\u00e8re permanente toutes les modifications que vous avez effectu\u00e9e depuis que cette page a \u00e9t\u00e9 publi\u00e9e pour la derni\u00e8re fois","editor.quit-dialog.title.blogpost.delete":"Supprimer l\u0027article de blog non publi\u00e9 ?","editor.quit-dialog.title.diff":"Changements non publi\u00e9s","editor.quit-dialog.title.discard":"Revenir \u00e0 la derni\u00e8re version publi\u00e9e?","editor.quit-dialog.title.page.delete":"Supprimer une page non publi\u00e9e ?","editor.quit-dialog.title.publish":"Publier tous les changements ?","template.content.ariaLabel":"Contenu du mod\u00e8le","page.content.ariaLabel":"Contenu de la page","blogpost.content.ariaLabel":"Contenu du billet de blog","content.ariaLabel":"Contenu","quick.comment.label.message":"R\u00e9diger un commentaire","aetable.align.top":"Aligner en haut","aetable.align.middle":"Aligner au milieu","aetable.align.bottom":"Aligner en bas"},l=function(e){var t=r[e];if(void 0!==t){for(var a=arguments.length,o=new Array(a>1?a-1:0),n=1;n<a;n++)o[n-1]=arguments[n];return o.length?d(t,...o):t}return i.a.error(`Translation missing for editor resource: ${e}`),e},d=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];return e&&1===(null==a?void 0:a.length)&&Array.isArray(a[0])?n.a.format(e,...a[0]):n.a.format(e,...a)}},function(e,t){e.exports=require("ajs")},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var o=a(3).a.get("context-path")},,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"cancelButton",(function(){return n})),a.d(t,"previewButton",(function(){return i})),a.d(t,"quitDialogHeader",(function(){return d})),a.d(t,"quitDialogContent",(function(){return s})),a.d(t,"saveButtonText",(function(){return c})),a.d(t,"saveButtonTitle",(function(){return u})),a.d(t,"saveButton",(function(){return g})),a.d(t,"contributorList",(function(){return r})),a.d(t,"hiddenInputCancel",(function(){return l}));var o=a(5),n=e=>{var t=e.contentType;return e.sharedDraftsEnabled&&t&&["page","blogpost"].includes(t)?'<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>':`<div class="aui-buttons cancel-button-container-shared-draft cancel-button-container-quick-edit">\n      <button class="aui-button toolbar-item" type="submit" id="rte-button-cancel" name="cancel" value="cancel">\n          <span class="trigger-text">${t&&["page","blogpost"].includes(t)?Object(o.a)("close.name"):Object(o.a)("cancel.name")}</span>\n      </button>\n  </div>`},i=()=>`<button class="aui-button toolbar-item" id="rte-button-preview" title="${Object(o.a)("tinymce.confluence.preview")}" type="button"><span class="trigger-text">${Object(o.a)("show.preview")}</span></button>`,r=e=>`<ul class="contributor-list">${null==e?void 0:e.map((e=>`<li><div class="contributor-avatar"><span class="aui-avatar aui-avatar-large"><span class="aui-avatar-inner"><img src="${e.avatarURL}"/></span></span></div><div class="contributor-name"><span>${e.fullname}</span></div></li>`)).join("")}</ul>`,l=()=>'<input type="hidden" name="cancel" value="cancel">',d=e=>{var t=e.dialogType,a=e.contentType,n=e.newPage;return`${(()=>{switch(t){case"revert":case"delete":return n?"blogpost"===a?`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.blogpost.delete")}</h2>`:`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.page.delete")}</h2>`:`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.discard")}</h2>`;case"publish":case"update":return`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.publish")}</h2>`;default:return`<h2 class="aui-dialog2-header-main">${Object(o.a)("editor.quit-dialog.title.diff")}</h2>`}})()}<button class="aui-close-button" type="button" aria-label=${Object(o.a)("close.name")}></button>`},s=e=>{var t=e.dialogType,a=e.contentType,n=e.contributors,i=e.newDialog;switch(t){case"revert":return n&&0!==(null==n?void 0:n.length)?`${Object(o.a)("editor.quit-dialog.revert.changes.by.many")}<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">${Object(o.a)("editor.quit-dialog.link.show.diff")}</a></div>${r(n)}`:`${"blogpost"===a?Object(o.a)("editor.quit-dialog.revert.blogpost.changes.by.one"):Object(o.a)("editor.quit-dialog.revert.page.changes.by.one")}<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">${Object(o.a)("editor.quit-dialog.link.show.diff")}</a></div>`;case"delete":return n&&0!==(null==n?void 0:n.length)?`${"blogpost"===a?Object(o.a)("editor.quit-dialog.delete.blogpost.changes.by.many"):Object(o.a)("editor.quit-dialog.delete.page.changes.by.many")}${r(n)}`:"blogpost"===a?Object(o.a)("editor.quit-dialog.delete.blogpost.changes.by.one"):Object(o.a)("editor.quit-dialog.delete.page.changes.by.one");case"publish":case"update":return`${Object(o.a)("editor.quit-dialog.publish.changes")}${r(n)}`;case"diff":return`<div><div class="legend"><span class="legend-title">${Object(o.a)("heading.key")}: </span><span class="diff-html-added">${Object(o.a)("these.lines.were.added")}</span><span class="diff-html-removed">${Object(o.a)("these.lines.were.removed")}</span><span class="diff-html-changed">${Object(o.a)("this.content.was.modified")}</span></div>${i?"":`<a class="aui-button aui-button-link" id="qed-hide-diff-button">${Object(o.a)("editor.quit-dialog.link.hide.diff")}</a>`}<hr/><div class="wiki-content"></div></div>`}},c=e=>{var t=e.contentType,a=e.sharedDraftsEnabled,n=e.isNewPage;return a&&t&&["page","blogpost"].includes(t)?n?Object(o.a)("publish.name"):Object(o.a)("update.word"):"blogpost"===t?Object(o.a)("editor.publish.blog"):Object(o.a)("editor.save.page")},u=e=>{var t=e.contentType,a=e.sharedDraftsEnabled,n=e.isNewPage;switch(t){case"blogpost":return Object(o.a)("editor.publish.blog.desc");case"page":return a?n?Object(o.a)("editor.shared.draft.publish.desc"):Object(o.a)("editor.shared.draft.update.desc"):Object(o.a)("editor.save.page.desc");default:return Object(o.a)("editor.save.page")}},g=e=>{var t=e.contentType,a=e.sharedDraftsEnabled,o=e.isNewPage;return`<button id="rte-button-publish" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="${u({contentType:t,sharedDraftsEnabled:a,isNewPage:o})}" tabindex="101">${c({contentType:t,sharedDraftsEnabled:a,isNewPage:o})}</button>`}},function(e,t){e.exports=require("confluence/meta")},,,,,function(e,t,a){"use strict";var o,n=a(6),i=a.n(n),r=a(1),l=a.n(r),d=a(0),s=a(8),c=a(5),u=a(3),g=a(2),p=a(12),f=a(13);!function(e){e.DELETE="delete",e.REVERT="revert",e.PUBLISH="publish",e.UPDATE="update",e.SHOW_DIFF="diff"}(o||(o={}));var b,h,m,v={},y={},x=[],T=!1,I=0,S=!1,A=!1,w=e=>{var t;e.stopPropagation(),e.preventDefault(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"}),null===(t=v.showDiffButton)||void 0===t||t.hide(),F((function(){var e;B(),null===(e=v.hideDiffButton)||void 0===e||e.show()}))},J=e=>{var t,a,o;e.stopPropagation(),e.preventDefault(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"}),null===(t=v.hideDiffButton)||void 0===t||t.hide(),null===(a=v.showDiffButton)||void 0===a||a.show(),null===(o=v.dialogEl)||void 0===o||o.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium"),R(m)},E=e=>{S||(m=b?o.REVERT:o.DELETE,U(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"}),e.stopPropagation(),e.preventDefault(),d.Confluence.Editor.UI.setButtonsState(!1,v.buttonsAll),L(u.a.get("content-id")))},q=()=>{var e;d.Confluence.Editor.Drafts.unBindUnloadMessage(),null===(e=v.editorForm)||void 0===e||e.append(Object(f.hiddenInputCancel)()).submit()},k=e=>{null!=e&&e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.keep-draft-clicked",data:{contributorCount:x.length+1}}),q()},O=e=>{var t;d.Confluence.Editor.UI.setButtonsState(!1,v.buttonsAll),null==y||null===(t=y.save)||void 0===t||t.call(y,e),U()},j=e=>{e.stopPropagation(),e.preventDefault(),m=null,Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.draft-status-indicator.click"}),F((function(){var e;null===(e=v.closeButton)||void 0===e||e.show(),B()}))},D=e=>{var t;e.stopPropagation(),e.preventDefault(),S||(null===(t=v.closeButton)||void 0===t||t.show(),u.a.get("new-page")?R(o.DELETE):R(o.REVERT))},_=e=>{var t;e.stopPropagation(),e.preventDefault(),null==v||null===(t=v.dialog)||void 0===t||t.hide()},B=()=>{var e;null===(e=v.dialogEl)||void 0===e||e.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge"),R(o.SHOW_DIFF),l.a.ajax({url:s.a+"/rest/tinymce/1/content/"+u.a.get("page-id")+"/draft/diff",type:"GET"}).done((e=>{var t,a,o=null===(t=v.dialogContent)||void 0===t?void 0:t.find(".wiki-content").html(e);null!=o&&o.children().first().hasClass("diff-context-placeholder")&&(null===(a=v.dialogContent)||void 0===a||a.find("hr").hide())}))},C=()=>{if(d.Confluence.Editor.UI.toggleSavebarBusy(!0),0===x.length)y.save&&y.save();else{F();var e=b?o.UPDATE:o.PUBLISH;R(e)}},$=e=>{d.Confluence.Editor.Drafts.save({forceSave:!0,skipErrorHandler:!1,onSuccessHandler:k,ignoreRelations:!(d.Confluence.Editor.hasContentChanged()&&A)});var t=d.Confluence.Editor.Drafts.getDraftSavingPromise();t&&t.fail((e=>{var t;null==y||null===(t=y.cancelErrorHandler)||void 0===t||t.call(y,e)})),e.namespace&&"heartbeat-error"===e.namespace||d.Confluence.Editor.UI.toggleSavebarBusy(!0)},R=e=>{var t,a,n,i,r,d=()=>e===o.SHOW_DIFF&&(m===o.REVERT||m===o.DELETE);e!==o.UPDATE&&e!==o.PUBLISH||(I=(new Date).getTime()/1e3);var s,c,g,p,b=e;(d()&&(b=m),null===(t=v.dialogHeader)||void 0===t||t.html(Object(f.quitDialogHeader)({dialogType:b,contentType:u.a.get("content-type"),newPage:u.a.get("new-page")})),null===(a=v.dialogContent)||void 0===a||a.html(Object(f.quitDialogContent)({dialogType:e,contributors:x,contentType:u.a.get("content-type"),newDialog:null==m})),v.hideDiffButton=l()("#qed-hide-diff-button").click(J),u.a.get("new-page"))||(e!==o.SHOW_DIFF&&(m=e),v.showDiffButton=l()("#qed-show-diff-button").click(w),v.showDiffButton.show(),null===(s=v.buttonsAll)||void 0===s||s.push(v.showDiffButton));e===o.DELETE||e===o.REVERT||d()?(null===(c=v.discardButton)||void 0===c||c.show(),null===(p=v.dialogEl)||void 0===p||p.addClass("aui-dialog2-warning")):null===(g=v.dialogEl)||void 0===g||g.removeClass("aui-dialog2-warning");null===(n=v.closeButton)||void 0===n||n.show(),null===(i=v.dialogFooter)||void 0===i||i.find("."+e).show(),null===(r=v.dialog)||void 0===r||r.show()},P=()=>{var e,t,a;U(),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"}),null===(e=v.dialogEl)||void 0===e||e.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium"),d.Confluence.Editor.UI.toggleSavebarBusy(!1),null===(t=v.dialogFooter)||void 0===t||t.find(".aui-button").hide(),null===(a=v.dialogContent)||void 0===a||a.empty()},U=()=>{var e=(new Date).getTime()/1e3-I;Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog."+m+".displayed",data:{displayTimeInSeconds:e,contentId:u.a.get("content-id")}}),I=0};function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=b?s.a+"/rest/synchrony/1.0/content/"+e+"/changes/unpublished":s.a+"/rest/api/content/"+e+"?status=draft";b&&p.a.suppressMessage("editor.synchrony.revert-page"),l.a.ajax({url:a,type:"DELETE",data:{draftId:e},contentType:"application/json",dataType:"json"}).done((()=>{b&&p.a.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:Object(c.a)("editor.discard-to-published.success.message")}),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:e}}),q()})).fail((a=>{if(409===a.status&&t<5)Object(g.b)("disable-draft-save"),L(e,t+1);else{var o,n,i,r,l,s=JSON.parse(a.responseText),u=Object(c.a)("draft.saving.error.could.not.delete"),f=a.errors||Object(c.a)("discard.draft.unknown.error");"content.delete.published"===(null==s||null===(o=s.data)||void 0===o||null===(n=o.errors)||void 0===n||null===(i=n[0])||void 0===i||null===(r=i.message)||void 0===r?void 0:r.key)&&(u=Object(c.a)("discard.draft.page-published.error.title"),f=Object(c.a)("discard.draft.page-published.error")),Object(g.b)("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",data:{contentId:e}}),Object(g.b)("enable-draft-save"),p.a.handleMessage("collaborative-editor-discard-error",{type:"error",title:b?Object(c.a)("editor.discard-to-published.error.title"):u,message:b?Object(c.a)("editor.discard-to-published.error.message"):f}),null==v||null===(l=v.dialog)||void 0===l||l.hide(),d.Confluence.Editor.UI.setButtonsState(!0,v.buttonsAll)}}))}var H=(e,t)=>{if(null!=t&&t.contributors){a=t.contributors,o=e=>e.name===u.a.get("remote-user"),x=a.filter((n=o,e=>!n(e)))}var a,o,n},F=e=>{d.Confluence.Editor.Drafts.save({forceSave:b,skipErrorHandler:!0,onSuccessHandler:e||l.a.noop})};t.a={init:e=>{if(h=u.a.getBoolean("shared-drafts")&&["page","blogpost"].includes(u.a.get("content-type")))if(T){var t;y.save=null==e?void 0:e.saveHandler,y.cancelErrorHandler=null==e?void 0:e.cancelErrorHandler,null===(t=v.publishButton)||void 0===t||t.click(O)}else{var a,o,n,r,s,c,p;if(b=!u.a.get("new-page"),v.discardButton=l()("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"}),d.Confluence.Editor.isLimitedModeEnabled()&&b)d.Confluence.Editor.UI.setButtonState(!1,v.discardButton),null===(c=v.discardButton)||void 0===c||c.removeAttr("disabled");else null===(p=v.discardButton)||void 0===p||p.click(E);v.saveExitButton=l()("#qed-save-exit-button").click(k),v.hideDiffButton=l()("#qed-hide-diff-button").click(J),v.publishButton=l()("#qed-publish-button"),v.closeButton=l()("#qed-close-button").click(_),v.buttonsAll=[v.discardButton,v.saveExitButton,v.showDiffButton,v.hideDiffButton,v.publishButton],v.dialog=i.a.dialog2("#quit-editor-dialog"),v.dialogEl=null===(a=v.dialog)||void 0===a?void 0:a.$el,v.dialogHeader=null===(o=v.dialogEl)||void 0===o?void 0:o.find(".aui-dialog2-header"),v.dialogContent=null===(n=v.dialogEl)||void 0===n?void 0:n.find(".aui-dialog2-content"),v.dialogFooter=null===(r=v.dialogEl)||void 0===r?void 0:r.find(".aui-dialog2-footer"),v.editorForm=l()("#wysiwyg").closest("form"),l()("#rte-show-changes").on("click",j),l()("#rte-show-revert").on("click",D),u.a.get("new-page")||l()("#pluggable-status").on("click","a",j),null===(s=v.dialog)||void 0===s||s.on("hide",P),Object(g.a)("editor-heartbeat",H),Object(g.a)("synchrony.history.evicted",(()=>{S=!0,l()("#qed-discard-button").attr("disabled","disabled")})),Object(g.a)("synchrony.connected",(()=>{A=!0})),T=!0}return v},process:e=>{h&&(e.stopPropagation(),e.preventDefault(),l()(window).one("editor-heartbeat rte.heartbeat-error",(function(t){switch(l()(this).off("editor-heartbeat rte.heartbeat-error"),e.target.id){case d.Confluence.Editor.UI.saveButton.attr("id"):case d.Confluence.Editor.UI.versionCommentInput.attr("id"):return C();case d.Confluence.Editor.UI.cancelButton.attr("id"):return $(t)}})),d.Confluence.Editor.heartbeat())},_destroy:()=>{T=!1,S=!1}}}]]);
}catch(e){WRMCB(e)};
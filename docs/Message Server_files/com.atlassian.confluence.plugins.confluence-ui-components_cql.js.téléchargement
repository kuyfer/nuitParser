WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<button class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('Supprimer le filtre') + '"></button>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Ajouter un filtre') + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a href="#" role="button" data-value="">' + soy.$$escapeHtml('N\x27importe quand') + '</a></li role="button"><li><a href="#" role="button" data-value="now(\'-1d\')">' + soy.$$escapeHtml('Derni\xe8res 24 heures') + '</a></li><li><a href="#" role="button" data-value="now(\'-1w\')">' + soy.$$escapeHtml('La semaine derni\xe8re') + '</a></li><li><a href="#" role="button" data-value="now(\'-1M\')">' + soy.$$escapeHtml('Le mois dernier') + '</a></li><li><a href="#" role="button" data-value="now(\'-1y\')">' + soy.$$escapeHtml('L\x27ann\xe9e derni\xe8re') + '</a></li><li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Personnalis\xe9') + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a href="#" role="button" data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a href="#" role="button" data-value="custom">' + soy.$$escapeHtml('Personnalis\xe9') + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">' + soy.$$escapeHtml('Rechercher des espaces archiv\xe9s') + '</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-soy-templates.js' */
define("confluence-ui-components/js/cql/internal/cql-soy-templates",[],function(){return{CQL:function(){return Confluence.UI.Components.CQL.Templates},Filters:function(){return Confluence.UI.Components.CQLFilters.Templates},FilterSelect:function(){return Confluence.UI.Components.CQL.FilterSelect.Templates},SpaceField:function(){return Confluence.UI.Components.CQL.SpaceField.templates},TypePicker:function(){return Confluence.UI.Components.CQL.TypePicker.templates}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(b){function d(a){return"search-screen"===a?b.omit(c,"conf_current"):c}var c={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"},e=b.invert(c);return{getMap:d,getKeys:function(a){return b.keys(d(a))},getUIValue:function(a){return e[a]}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(b,d,e){var c;return{getFields:function(){c||(c=b.Deferred(),b.getJSON(e.contextPath()+"/rest/cql/fields?filter\x3dwithUiSupport").done(function(a){a=d.values(a);if(!a.length)throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.");a=d.union.apply(d,a);a=d.sortBy(a,"fieldName");c.resolve(a)}).fail(function(){c.reject()}));return c.promise()},parseClauses:function(a){return b.getJSON(e.contextPath()+
"/rest/cql/expressions?cql\x3d"+encodeURIComponent(a))},getTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dall")},getContentTypes:function(){return b.getJSON(e.contextPath()+"/rest/cql/contenttypes?category\x3dcontent")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-date-picker",["ajs","jquery","confluence-ui-components/js/internal/soy-templates"],function(b,g,n){return{build:function(p){var c=g(n.DatePicker().input()),d=c.find(".aui-nav li"),k=c.find(".absolute-date-pickers").hide(),e=c.find(".from-date-picker"),f=c.find(".to-date-picker"),l=function(){};this.onChange=function(a){l=a;e.change(a);f.change(a)};c.on("click",".aui-nav a",function(a){a.preventDefault();a=d.filter("li.aui-nav-selected");var h=g(this).closest("li");
a[0]!==h[0]&&(d.not(h).removeClass("aui-nav-selected"),h.addClass("aui-nav-selected"),l());"custom"===g(this).data("value")?k.slideDown("fast"):k.slideUp("fast")});var m={overrideBrowserDefault:!0};b.DatePicker(e,m);b.DatePicker(f,m);e.attr("placeholder","De");e.attr("aria-label","De");f.attr("placeholder","\u00c0");f.attr("aria-label",
"\u00c0");p.replaceWith(c);return{getSelectedOption:function(){return d.filter(".aui-nav-selected").find("a").data("value")},selectOption:function(a){d.find('a[data-value\x3d"'+a+'"]').click()},getFromDate:function(){return e.val()},getToDate:function(){return f.val()},setFromDate:function(a){e.val(a);d.find("a[data-value\x3d'custom']").click()},setToDate:function(a){f.val(a);d.find("a[data-value\x3d'custom']").click()}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-type-picker","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/confluence-select".split(" "),function(k,e,u,v,x,y,z){function A(c){l=e.map(c,function(h){return{id:h.type,text:h.label}})}function w(c,h){return 0===c.length?"":
1===c.length&&e.contains(e.pluck(h,"type"),c[0])?c[0]:"custom"}var f,l=[];return{build:function(c,h){var g,m,n,p=[];f||(f=h?v.getContentTypes():v.getTypes(),f.done(A));f.done(function(){if(c.length){var b=e.pluck(l,"id");p=[].concat(l);c.forEach(function(a){""===a.type||e.contains(b,a.type)||p.push({id:a.type,text:a.label})})}else p=l});var B={query:function(b,a,d){f.done(function(){a(b.term);window.Select2.query.local({results:e.map(p,d)})(b)})},initSelection:function(b,a){b=b.val().split(",");var d=
"",r=e.map(b,function(q){return"-"===q.charAt(0)?(d="-",q.substring(1)):q});f.done(function(){var q=e.filter(p,function(t){return e.contains(r,t.id)});a(e.map(q,function(t){return{id:d+t.id,text:d+t.text}}))})},multiple:!0,placeholder:"Tous les types de contenu"};return{setupInput:function(b){g=b;if(u.trace)g.on("change",function(){u.trace("type.field.changed")});c.length&&(b=k(y.TypePicker().suggestions({types:c})),m=b.find(".aui-nav li"),g.before(b),b.on("click",
".aui-nav a",function(a){a.preventDefault();a=k(this).closest("li");var d=m.filter(".aui-nav-selected");a[0]!==d[0]&&(d.removeClass("aui-nav-selected"),a.addClass("aui-nav-selected"),a=k(this).attr("data-value"),"custom"===a?(n.slideDown("fast"),k(this).attr("id","type-picker-custom")):n.hide(),g.select2("val",[a],!0))}));g.confluenceSelect(z.build(B),["type-picker-custom"]);c.length&&(n=g.closest(".cql-filter").find(".select2-container"),n.hide())},setValues:function(b){if(m){var a=w(b,c),d=m.find('[data-value\x3d"'+
a+'"]').parent();m.not(d).removeClass("aui-nav-selected");d.addClass("aui-nav-selected");"custom"===a&&n.show()}var r=k.Deferred();f.done(function(){x.setValues(g,b).done(function(){r.resolve()})});return r}}},_clearCache:function(){f=null;l=[]},_getPicklistKey:w}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){return{getLabel:function(a){return a.uiSupport.label.translation}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(e,f){return{convertFunctionValues:function(a){var b=a.functionValues;if(!b||!b.length)return a;var c=[];e.each(b,function(d){if("currentSpace"===d.functionName)c.push(f.getUIValue("currentSpace()"));else throw Error(d.functionName+" is not a known function");});a.values=c.concat(a.values);return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field",["jquery","ajs","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper"],function(f,d,l,m){function g(a){return{query:a,searchContext:JSON.stringify({spaceKey:d.Meta.get("space-key"),contentId:d.Meta.get("content-id")})}}function h(a){return 0===a.indexOf("http://")||0===a.indexOf("https://")?a:d.contextPath()+a}var k={placeholder:"Commencez \u00e0 taper pour effectuer une recherche",
multiple:!0,tokenSeparators:[" ",","],createSearchChoice:function(a){return a?{id:a,text:"New result: "+a,isNew:!0}:null},createSearchChoicePosition:"bottom",ajax:{data:g,results:function(a){var b=a.suggestedResults;a=a.searchResults;b=b.length?a.length?[{text:"Suggestions",children:b},{text:"R\u00e9sultats de la recherche",children:a}]:b:a;return{results:b}},quietMillis:300},initSelection:function(a,
b){a=a.val().split(",").map(function(c){return{id:c,text:c}});b(a)}};return{build:function(a){var b;return{setupInput:function(c){b=c;var e=f.extend({},k.ajax,{url:h(a.uiSupport.dataUri)});e=f.extend({},k,{ajax:e});c.auiSelect2(e)},asCqlFunc:function(){var c=this.input.val().trim();if(c)return l.buildEqualityExpressionFromValuesString(this.fieldName,c)},setValues:function(c){return m.setValues(b,c.values)}}},_getUrl:h,_ajaxData:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field",["jquery","confluence-ui-components/js/page-picker","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-set-value-helper","confluence-ui-components/js/confluence-select"],function(k,d,e,f){function g(b){return"page:"+b}function h(b){return"content-function:"+b.functionName+"()"}function c(b){return b.values.map(g).concat(b.functionValues.map(h))}return{build:function(){var b;
return{setupInput:function(a){b=a;a.confluenceSelect(d.build({multiple:"parent"!==this.fieldName,suggestedContentFunctions:["currentContent()"]}))},asCqlFunc:function(){var a=this.input.val().trim();if(a)return a=a.replace(/[a-z\-]+:/g,""),e.buildEqualityExpressionFromValuesString(this.fieldName,a)},_addValuePrefixes:c,setValues:function(a){a=c(a);return f.setValues(b,a)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions",["ajs"],function(a){var b=[{type:"",label:"Tout le contenu"},{type:"page",label:"Pages"},{type:"blogpost",label:"Billets de blog"},{type:"attachment",label:"Pi\u00e8ces jointes"},{type:"space",
label:"Espaces"}];return{getList:function(){return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field",["confluence/dark-features","confluence-ui-components/js/cql/internal/cql-type-picker","confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions"],function(f,g,h){return{build:function(k){var a;return{setupInput:function(b,c){var d=[],e=!0;if("search-screen"===c.environment&&"all"===c.searchType||f.isEnabled("cql.force.full.search.mode"))d=h.getList(),e=!1;a=g.build(d,e);a.setupInput(b)},setValues:function(b){return a.setValues(b.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field",["ajs","underscore","confluence-ui-components/js/cql/internal/cql-date-picker"],function(e,h,k){return{build:function(l){var g=l.fieldName,b;return{setupInput:function(a){b=k.build.call(this,a)},setValues:function(a){b?(a=a.expressions,1>a.length||2<a.length?e.warn("Can't set date value with expressions.length: "+a.length):1===a.length&&1===a[0].functionValues.length&&"now"===a[0].functionValues[0].functionName?"\x3e\x3d"!==
a[0].operator?e.warn("Unsupported date picker relative date operator: "+a[0].operator):b.selectOption("now('"+a[0].functionValues[0].parameters[0]+"')"):h.each(a,function(c){if(1===c.values.length){var d=c.values[0];"\x3e\x3d"===c.operator?b.setFromDate(d):"\x3c\x3d"===c.operator&&b.setToDate(d)}})):e.warn("DatePicker not set yet, can't set values")},asCqlFunc:function(){if(b){var a=b.getSelectedOption();if(!a)return"";if("custom"===a){a=b.getFromDate();var c=b.getToDate(),d,f;a&&(d=g+' \x3e\x3d "'+
a+'"');c&&(f=g+' \x3c\x3d "'+c+'"');return d&&f?d+" and "+f:d||f||""}return g+" \x3e\x3d "+a}e.warn("DatePicker not set yet, can't get CQL")}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field","jquery ajs confluence-ui-components/js/label-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/confluence-select".split(" "),function(d,e,f,g,h){return{build:function(){var c;return{setupInput:function(a,b){c=a;b=d.extend({},b.select2CustomOptions,{noMatches:"\u00c9tiquettes correspondantes introuvables"});
a.confluenceSelect(g.build(f.build(b)))},setValues:function(a){return h.setValues(c,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field","jquery confluence-ui-components/js/space-picker confluence-ui-components/js/include-exclude-picker confluence-ui-components/js/cql/internal/cql-special-spaces confluence-ui-components/js/cql/internal/cql-space-expression-adjuster confluence-ui-components/js/cql/internal/cql-space-expression-builder confluence-ui-components/js/cql/internal/cql-set-value-helper confluence-ui-components/js/cql/internal/cql-soy-templates confluence-ui-components/js/confluence-select".split(" "),
function(f,g,h,k,l,m,n,p){return{build:function(){var b;return{setupInput:function(a,c){b=a;a.confluenceSelect(h.build(g.build({multiple:!0,suggestCategories:k.getKeys(c.environment),disableMixedSpaceTypes:!0})));if("search-screen"===c.environment){var d=f(p.SpaceField().archivedSpacesOption());b.after(d);this.onChange=function(e){d.find("#search-filter-include-archived").change(e);b.change(e)}}},asCqlFunc:function(){return m.buildExpressionFromValuesString(this.input.val())},setValues:function(a){l.convertFunctionValues(a);
return n.setValues(b,a.values)}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field",["jquery","ajs","confluence-ui-components/js/user-group-select2"],function(b,f,g){return{build:function(){function h(a){a=a[0].result[0];return{id:a.username,text:a.title,imgSrc:a.thumbnailLink.href}}var d;return{setupInput:function(a){d=a;a.addClass("select2-input autocomplete-multiusergroup");g.bind(a.parent())},setValues:function(a){if((a=a.values)&&a[0]){var e=a.map(function(c){return b.getJSON(f.contextPath()+
"/rest/prototype/1/search/user.json?query\x3d"+encodeURI(c))});return b.when.apply(b,e).done(function(){var c=(1<e.length?arguments:[arguments]).map(h);d.auiSelect2("data",c)})}}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define("confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs","confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field".split(" "),
function(d,e,f,g,h,k,l){var c={contentId:e,contentType:f,date:g,label:h,space:k,user:l};return{getConfig:function(a){var b=a.uiSupport;return b.dataUri?d.build(a):c[b.valueType]?c[b.valueType].build(a):{}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-expression-builder confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(e,g,t,h,k,l,m){function n(b){var d=h.getLabel(b);d=e(p().baseFilterField({label:d,field:b,counter:q++}));var c=d.find("input");d.data("fieldName",
b.fieldName);return e.extend({input:c,element:d,onChange:function(a){c.change(a)}},b)}var p=m.Filters,q=0;return{build:function(b,d){var c=b.fieldName;if(!b.uiSupport.valueType)throw Error("Can't create filter without valueType.");if(!c)throw Error("Can't create filter without fieldName.");c=l.getConfig(b);var a=n(b);a.asCql=g.bind(c.asCqlFunc||function(){return k.buildExpression(a,this.input.val())},a);var f=a.element.find("input");"function"===typeof c.setupInput&&(a.setupInput=c.setupInput,a.setupInput(f,
d.context));a.setValues=c.setValues||function(r){f.val(r.values.join(","))};a.element.find(".aui-iconfont-remove").click(function(){a.element.remove();d.removeField(a)});return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-field-model confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),function(k,c,b,t,l,u){var v=u.FilterSelect;return{build:function(g){function w(a){a.added&&(h.auiSelect2("val",""),n(a.added),b.debug("CQL Field selection made"),m.addClass("hidden"),d.show())}var p=g.cqlContainer,q=p.find(".cql-fields"),
n=g.onSelection;if(!n)throw Error("An onSelection callback must be provided to the FilterSelect.");var e=k(v().container()),d=e.children("button"),m=e.find(".input-wrapper"),h=e.find("input");d.click(function(a){a.preventDefault();m.removeClass("hidden");d.hide();e.find(".select2-choice").mousedown()});h.bind("select2-close",function(){b.debug("CQL Field selector closed");m.addClass("hidden");d.show();setTimeout(function(){b.log("Checking CQL Field selector focus");k(document.activeElement).closest(".cql-filter").length||
(b.debug("Setting CQL Field selector focus"),d.focus())},1)});p.append(e);t.getFields().done(function(a){"search-screen"===g.context.environment||b.DarkFeatures.isEnabled("cql.search.screen")||(a=c.reject(a,function(f){return"date"===f.type}));a=c.reject(a,function(f){return c.contains(g.ignoredFields,f.fieldName)});h.auiSelect2({id:"fieldName",data:function(){if(!q[0])throw Error("Why no cql-container?");var f=q.find(".cql-filter").map(function(){return k(this).data("fieldName")});return{results:c.reject(a,
function(r){return c.contains(f,r.fieldName)&&!c.contains(["label"],r.fieldName)}),text:l.getLabel}},formatResult:l.getLabel,formatSelection:l.getLabel,placeholder:"Ajouter un filtre"}).change(w)}).fail(function(){b.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")});return h}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(l,e,f,g){return{buildExpressionFromValuesString:function(a){if(a=a.trim()){a=a.split(",");var h=f.getKeys(),d=[],c=[];e.each(a,function(b){"conf_current"===b?d.push("currentSpace()"):e.contains(h,b)?c.push(b):d.push(b)});a=[];if(c.length){var k=f.getMap();c=e.map(c,
function(b){return k[b]});a.push(g.buildEqualityExpressionFromValuesArray("space.type",c))}d.length&&a.push(g.buildEqualityExpressionFromValuesArray("space",d));return 1===a.length?a[0]:"("+a.join(" or ")+")"}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(q,e){function f(b){return e.contains(["currentContent()","currentSpace()"],b)?b:'"'+b.replace(/"/g,'\\"')+'"'}function g(b){var a={"+":[],"-":[],"":[]};e.each(b,function(c){var d=c.charAt(0);"+"===d?a["+"].push(c.substring(1)):"-"===d?a["-"].push(c.substring(1)):a[""].push(c)});return a}function h(b,a){return e.map(a,function(c){return b+" \x3d "+f(c)}).join(" AND ")}function k(b,a,c){if(0===
a.length)return"";a=e.map(a,f);if(1===a.length)return b+(c?" \x3d ":" !\x3d ")+a[0];a=a.join(",");return b+(c?" in ":" not in ")+"("+a+")"}function l(b,a){return k(b,a,!1)}function m(b,a){return k(b,a,!0)}function n(b,a){var c=g(a);a=[];var d=h(b,c["+"]);d&&a.push(d);(d=m(b,c[""]))&&a.push(d);(b=l(b,c["-"]))&&a.push(b);return a.join(" AND ")}function p(b,a){if(a=a.trim())return a=a.split(","),a=e.map(a,function(c){return c.trim()}),n(b,a)}return{buildExpression:function(b,a){if("equality"===b.type)return p(b.fieldName,
a);if("text"===b.type)return b=b.fieldName,a=(a=a.trim())?b+" ~ "+f(a):void 0,a;throw Error("buildExpression does not yet support type: "+b.type);},buildEqualityExpressionFromValuesString:p,buildEqualityExpressionFromValuesArray:n,makeValueMap:g,makePlusCql:h,makeMinusCql:l,makeRegularCql:m}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,d){return{convert:function(c,a){a=b.clone(a);var e=b.map(c.values,d.getUIValue);return{field:a,values:e,negate:c.negate}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(d,h){function g(a,b){a.values=a.values.concat(b.values);return a}return{aggregate:function(a,b){var c=d.filter(a,function(e){return"space.type"===e.field.fieldName});if(0===c.length)return a;if(1<c.length)throw Error("Only a single space.type expression is supported.");b=h.convert(c[0],b);var f=d.filter(a,function(e){return"space"===
e.field.fieldName});a=d.difference(a,c);f.length?f[0]=g(f[0],b):a.push(b);return a},combineSpaceExpressions:g}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define("confluence-ui-components/js/cql/internal/cql-set-value-helper",["jquery"],function(c){return{setValues:function(a,d){var b=c.Deferred();a.on("change",function(){b.resolve()});a.select2("val",d,!0);return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-date-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(f){return{aggregate:function(e){var b=[],c={};e.forEach(function(a){var d=a.field.fieldName;"date"!==a.field.type?b.push(a):c[d]?c[d].expressions.push(a):(a={field:a.field,expressions:[a]},c[d]=a,b.push(a))});return b}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["jquery","underscore"],function(c,d){function b(a){a.values=d.map(a.values,function(e){return"-"+e})}return{convert:function(a){a=c.extend({},a);"equality"===a.field.type&&("!\x3d"===a.operator?(a.operator="\x3d",b(a)):"notin"===a.operator&&(a.operator="in",b(a)));return a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(g,l){function m(e,b){if(!b.length)return e;var a=e[0];a||(a=b[0],b=g.rest(b));b.forEach(function(f){a.values=a.values.concat(f.values)});"\x3d"===a.operator&&1<a.values.length&&(a.operator="in");return[a].concat(g.rest(e))}return{aggregate:function(e){var b=[],a={},f={};e.forEach(function(c){var d=c.field.fieldName;g.contains(b,d)||(b.push(d),
a[d]=[],f[d]=[]);var h=l.convert(c);h.operator!==c.operator?f[d].push(h):a[d].push(h)});var k=[];b.forEach(function(c){c=m(a[c],f[c]);k=k.concat(c)});return k}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter",[],function(){function c(a,b,d){b&&(a=a.filter(function(e){return-1<b.indexOf(e.field.fieldName)?d:!d}));return a}return{removeFieldsByName:function(a,b){return c(a,b,!1)},getFieldsByName:function(a,b){return c(a,b,!0)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component","jquery underscore ajs confluence-ui-components/js/cql/internal/cql-ajax confluence-ui-components/js/cql/internal/cql-filter-field confluence-ui-components/js/cql/internal/cql-filter-select confluence-ui-components/js/cql/internal/cql-space-expression-aggregator confluence-ui-components/js/cql/internal/cql-date-expression-aggregator confluence-ui-components/js/cql/internal/cql-negation-aggregator confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter confluence-ui-components/js/cql/internal/cql-soy-templates".split(" "),
function(e,k,g,x,I,J,K,L,M,y,N){function O(c){var f=[];k.each(c,function(n){n.forEach(function(h){h&&(h=h.asCql())&&f.push(h)})});return f.join(" and ")}function z(c,f){return k.find(c,function(n){return n.fieldName===f})}var P=N.CQL;return{build:function(c){function f(a){var b=I.build(a,A);b.onChange(B);a=a.fieldName;d[a]=d[a]||[];d[a].push(b);p.trigger("cql-field-adding",b);a=C.find(".cql-field-"+a+":last");a.length?a.after(b.element):C.append(b.element);return b}function n(a){var b=e.Deferred();
if(!a)return b.resolve(),b;var l={},Q=k.findWhere(r,{fieldName:"space"});a=K.aggregate(a,Q);a=L.aggregate(a);a=M.aggregate(a);D=y.getFieldsByName(a,c.ignoredFields);a=y.removeFieldsByName(a,c.ignoredFields);var E=[];k.each(a,function(t){var m=t.field.fieldName,F=z(r,m),q=l[m];l[m]="number"===typeof q?q+1:0;m=l[m];q=F.fieldName;(t=(d[q]&&d[q][m||0]||f(F)).setValues(t))&&E.push(t)});e.when.apply(e,E).then(function(){b.resolve()});return b}function h(a){if(a){var b=k.escape(a);a="Nous ne pouvons pas charger vos filtres";
b=g.format("Jurons ! Nous avons eu des probl\u00e8mes avec \u00ab {0} \u00bb. Essayez d\u0027\u0027actualiser la page. Il vous faudra peut-\u00eatre saisir de nouveau les param\u00e8tres de votre macro.",b)}else a="Nous n\u0027avons pas pu charger la macro",b="Si vous actualisez la page, on essaiera de nouveau.";g.messages.error(".cql-error-container",{title:a,body:b,closeable:!0})}function R(a){a=e.extend({},a,{fixed:!1});a=f(a);if(0===a.element.find(".aui-nav-selected").length)if(0!==a.element.find(".select2-container-multi").length){var b=a.element.find("input.select2-input");
b.focus().click()}else b=a.element.find("a.select2-choice.select2-default"),b.length||(b=e(":input:visible",a.element).first()),b.length||g.log("Unable to focus CQL field: "+a.fieldName),b.focus().mousedown()}var G=c.context||{environment:"macro-browser"},u=c.defaultFieldNames;u||(u=c.defaultFields?c.defaultFields.split(","):[]);var p=e(P().container());c.container&&e(c.container).append(p);var C=p.find(".cql-fields"),H=c.value||c.defaultValue;if(H)var v=x.parseClauses(H);else v=new e.Deferred,v.resolve();
var d={},D={},w=new e.Deferred,B=c.onChange||function(){},A={element:p,loading:w,context:c.context||{environment:"macro-browser",searchType:"content",select2CustomOptions:c.select2CustomOptions||{}},getValue:function(){return O(d)},getIgnoredFields:function(){return D},removeField:function(a){var b=a.fieldName;d[b]=k.without(d[b],a);0===d[b].length&&(delete d[b],B())},fieldArrays:d,fieldRegistry:d},r;x.getFields().done(function(a){r=a;u.forEach(function(b){var l=z(r,b);if(!l)throw Error("Unknown fieldname: "+
b);b=e.extend({fixed:!0},l);f(b)});J.build({onSelection:R,cqlContainer:p,context:G,ignoredFields:c.ignoredFields});v.done(function(b){n(b).done(function(){w.resolve()})}).fail(function(){"search-screen"===G.environment?g.log("Error parsing CQL param from search screen URL: "+c.value):h(c.value);w.resolve()})}).fail(function(){h()});return A}}});
}catch(e){WRMCB(e)};